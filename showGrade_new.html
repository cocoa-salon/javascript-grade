<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>

<body>
    <script>

        // 학점 계산기 

        // 과목 정보 객체 생성
        var data = [
            {
                'name': '데이터베이스',
                'grade': 'A',
                'credit': 3,
                'major': false
            },
            {
                'name': '교양영어',
                'grade': 'A+',
                'credit': 2,
                'major': true
            },
            {
                'name': '철학',
                'grade': 'B+',
                'credit': 1,
                'major': false
            },
            {
                'name': '컴퓨터공학',
                'grade': 'C+',
                'credit': 2,
                'major': true
            },
            {
                'name': '자료구조개론',
                'grade': 'B+',
                'credit': 2,
                'major': true
            },
            {
                'name': '빅데이터응용',
                'grade': 'B',
                'credit': 3,
                'major': true
            }
        ];

        // 객체 생성(네임 스페이스 설정)
        const getGrade = {};


        // main 메소드 
        getGrade.showGrade = function (data) {
            console.log(
                `${this.getGpa(data)},  ${this.getGpaMajor(data)},  ${this.getCredit(data)},  ${this.getCreditMajor(data)}`
            );
            console.log(
                `총과목 수: ${data.length}\n전공과목 수: ${this.countMajor}`
            );
        }

        // 학점, 숫자를 나타내는 객체 생성
        getGrade.pointScale = {
            "A+": 4.5,
            "A": 4,
            "B+": 3.5,
            "B": 3,
            "C+": 2.5,
            "C": 2,
            "D+": 1.5,
            "D": 1
        }

        // 4.0기준 학점 계산을 위해 플러스 학점을 일정 부분 제하는 메소드
        getGrade.subtractPlus = function (data) {
            let subtractPlus = 0; 
            data.forEach(val => {
                if (val.grade === "A+") {
                    subtractPlus += 0.5;
                }
                if (val.grade === "B+" || val.grade === "C+" || val.grade === "D+") {
                    subtractPlus += 0.2;
                }
            })
            return subtractPlus;
        }

        // 총평점 메소드
        getGrade.getGpa = function (data) {
            let gpa = 0; // 4.5기준 평점
            let gpa4 = 0; // 4.0기준 평점
            let sumPoint = 0; // 학점 합계
            data.forEach(val => {
                sumPoint += getGrade.pointScale[val.grade];
            });
            gpa = (sumPoint / data.length).toFixed(2);
            gpa4 = ((sumPoint - this.subtractPlus(data)) / data.length).toFixed(2);
            return `4.5기준 총평점: ${gpa}(4.0기준: ${gpa4})`;
        }

        // 전공평점 메소드
        getGrade.getGpaMajor = function (data) {
            let gpa = 0; // 4.5기준 평점
            let gpa4 = 0; // 4.0기준 평점
            let sumPoint = 0; // 학점 합계
            this.countMajor = 0; // 전공 과목 수

            // 전공 과목만 필터링 후 학점 계산
            let majorClass = data.filter(val => val.major);

            majorClass.forEach(val2 => {
                sumPoint += getGrade.pointScale[val2.grade];
                this.countMajor += 1;
            });
            gpa = (sumPoint / this.countMajor).toFixed(2);
            gpa4 = ((sumPoint - this.subtractPlus(majorClass)) / this.countMajor).toFixed(2);
            return `전공평점: ${gpa}(4.0기준: ${gpa4})`;
        }

        // 이수학점 메소드
        getGrade.getCredit = function (data) {
            let credit = 0
            data.forEach(val =>
                credit += val.credit
            );
            return `이수학점: ${credit}`;
        }

        // 전공이수학점 메소드
        getGrade.getCreditMajor = function (data) {
            let credit = 0
            data.forEach(val => {
                if (val.major) {
                    credit += val.credit;
                }
            })
            return `전공이수학점: ${credit}`;
        }

        // main 메소드 실행
        getGrade.showGrade(data);

    </script>

</body>

</html>