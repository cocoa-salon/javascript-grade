<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>

<body>
    <script>

        // 학점 계산기 

        // 과목 정보 객체 생성
        var gradeData = [
            {
                'name': '데이터베이스',
                'grade': 'A',
                'credit': 3,
                'major': false
            },
            {
                'name': '교양영어',
                'grade': 'A+',
                'credit': 2,
                'major': true
            },
            {
                'name': '철학',
                'grade': 'B+',
                'credit': 1,
                'major': false
            },
            {
                'name': '컴퓨터공학',
                'grade': 'C+',
                'credit': 2,
                'major': true
            },
            {
                'name': '자료구조개론',
                'grade': 'B+',
                'credit': 2,
                'major': true
            },
            {
                'name': '빅데이터응용',
                'grade': 'B',
                'credit': 3,
                'major': true
            }
        ];

        // 객체 생성(네임 스페이스 설정)
        const gradeInfo = {};

        // main 메소드 
        gradeInfo.showGradeInfo = function (gradeData) {
            console.log(
                `${this.calGpaTotal(gradeData)},  ${this.calGpaMajor(gradeData)},  ${this.calCredit(gradeData)},  ${this.calCreditMajor(gradeData)}`
            );
            console.log(
                `총과목 수: ${gradeData.length}\n전공과목 수: ${this.countMajor}`
            );
        }

        // 학점, 숫자를 나타내는 객체 생성
        gradeInfo.pointScale = {
            "A+": 4.5,
            "A": 4,
            "B+": 3.5,
            "B": 3,
            "C+": 2.5,
            "C": 2,
            "D+": 1.5,
            "D": 1
        }

        // 4.0기준 학점 계산을 위해 플러스 학점을 일정 부분 제하는 메소드
        gradeInfo.subtractPlus = function (gradeData) {
            let subtractPlus = 0; 
            gradeData.forEach(val => {
                if (val.grade === "A+") {
                    subtractPlus += 0.5;
                }
                if (val.grade === "B+" || val.grade === "C+" || val.grade === "D+") {
                    subtractPlus += 0.2;
                }
            })
            return subtractPlus;
        }

        // 총평점 메소드
        gradeInfo.calGpaTotal = function (gradeData) {
            let gpaFourPointFive = 0, // 4.5기준 평점
                gpaFourPointZero = 0, // 4.0기준 평점
                sumPoint = 0; // 학점 합계
            gradeData.forEach(val => {
                sumPoint += gradeInfo.pointScale[val.grade];
            });
            gpaFourPointFive = (sumPoint / gradeData.length).toFixed(2);
            gpaFourPointZero = ((sumPoint - this.subtractPlus(gradeData)) / gradeData.length).toFixed(2);
            return `4.5기준 총평점: ${gpaFourPointFive}(4.0기준: ${gpaFourPointZero})`;
        }

        // 전공평점 메소드
        gradeInfo.calGpaMajor = function (gradeData) {
            let gpaFourPointFive = 0,  // 4.5기준 평점
                gpaFourPointZero = 0, // 4.0기준 평점
                sumPoint = 0; // 학점 합계
            this.countMajor = 0; // 전공 과목 수

            // 전공 과목만 필터링 후 학점 계산
            let majorClass = gradeData.filter(val => val.major);

            majorClass.forEach(val => {
                sumPoint += gradeInfo.pointScale[val.grade];
                this.countMajor += 1;
            });
            gpaFourPointFive = (sumPoint / this.countMajor).toFixed(2);
            gpaFourPointZero = ((sumPoint - this.subtractPlus(majorClass)) / this.countMajor).toFixed(2);
            return `전공평점: ${gpaFourPointFive}(4.0기준: ${gpaFourPointZero})`;
        }

        // 이수학점 메소드
        gradeInfo.calCredit = function (gradeData) {
            let credit = 0;
            gradeData.forEach(val =>
                credit += val.credit
            );
            return `이수학점: ${credit}`;
        }

        // 전공이수학점 메소드
        gradeInfo.calCreditMajor = function (gradeData) {
            let credit = 0;
            gradeData.forEach(val => {
                if (val.major) {
                    credit += val.credit;
                }
            })
            return `전공이수학점: ${credit}`;
        }

        // main 메소드 실행
        gradeInfo.showGradeInfo(gradeData);

    </script>

</body>

</html>